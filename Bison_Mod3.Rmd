---
title: "Bison"
date: "2023-11-15"
output: html_document
---
### Figuring out a general workflow for this module
1) setwd, all of the same beginning stuff as usual. Don't even put the space for that, they should know to do that by now, but can maybe leave a small reminder.
2) Looking at all of the data: Biomass data and then maybe also a data frame that just has the size information of the different sites (in acres)
3) group in dplyr "group_by" so that they can get data for each site
4) Ask them to find the average biomass at each site (how to get summary statistics of groups)
5) Convert biomass units to match with acre units: Using mutate to make a new column that is a math function of existing column
6) Ask them to calculate the average biomass/acre at each site
7) Ask them to calculate the estimated total biomass at each site (avg biomass/acre * total acres)
8) Ask them to figure out if/which sites can support a viable Bison population (which will be described)
9) Ask them to figure out how many Bison each site can support in total
10) Ask them to think about, discuss, and explain the action that they would recommend to the K'avi community takes for Bison reintroduction: should entire bison population go to just one site, split amongst multiple sites, no sites at all? 
11) Ask them to make plots that can effectively communicate their decision.

Other considerations for this module, particularly in regards to a second day for this module: 
Include tibbles in here somewhere? Need to look more into tibbles and how they can be useful in this context!
  Potentially having them do this within the context of open-range Bison, where there are not any fences and they are only dealing with a single site. That could be what they do for the first day, and then do the work with three sites on the second day?
  
  Could also add the dimension of biomass varying seasonally, or year to year, or under threats like climate change. Can these sites support a Bison herd during the winter, when biomass is lower and nutrients are less available?
          For this, could have a second "winter" dataset, and maybe ask them to merge the two datasets, but also make a new column with the variable "summer" or "winter" that corresponds to the season the data was collected. 
          
  Could ~maybe~ bring in demography of bison and having them build population dynamics model of the bison to further see what the viable population is, how maximum bison from biomass may actually be different from their actual carrying capacity, etc. This would really only be for the students more proficient in R that are looking for an extra challenge, but could be useful more generally if the students are wondering about some of these topics as they pursue their own research questions for this module. Would require a lot of additional work though, which may not be feasible given the amount of remaining time in the semester.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Set your working directory and load in tidyverse
```{r set wd}
current_path = rstudioapi::getActiveDocumentContext()$path #For editing purposes! Students would have to do this step on their own
setwd(dirname(current_path))
```
## R Markdown

For many years, the K'Avi tribe has had cattle grazing pastures throughout their land.
Cattle have been a useful agricultural resource, but they are not native to the K'Avi's
region. In the past year, tribal agriculture managers have noticed a decreased vitality 
in many of their grazing lands causing less regrowth and a decrease in native plant species.
This is most likely due to the cattle, as they are non-specific grazers and are a non-native
species. Tribal agriculture managers are considering reintroducing bison to the lands for
both ecological and cultural reasons. Bison are native to this region and have been observed
to increase native grass species richness by 103% in comparison to cattle! The managers are
hoping to repurpose the cattle grazing lands to become bison grazing lands to encourage a
more sustainable agricultural practice for the region and to ensure the preservation of the
native grasslands.

To reintroduce bison, the land must have enough available sustenance for the bison to graze
and maintain a healthy lifestyle. The tribal agriculture managers are considering
several sites for reintroduction and have received a dataset with plant biomass data at each
site. The data available will help determine which sites are viable for bison reintroduction!

```{r set wd}
current_path = rstudioapi::getActiveDocumentContext()$path
setwd(dirname(current_path))
```
#Load in tidyverse
```{r tidy}
library(tidyverse)
```

##Load in Biomass Data and Site Datasets
```{r}
biomass <- read.csv("Bison_Mod3/biomass.csv", header = TRUE, sep = ',') #this is for our purposes, this would not be written for students in this module
sites <- read.csv("bison_sites.csv", header = TRUE, sep = ',')
```

#Look at all of the data

*Evan: Maybe ask them to get the average biomass / quadrat at each site? Depending on what they learn in Module 2, they should already know generally how to get stats for multiple sites, so they may not need to have group_by explained to them. Consult with Mod2*
Prompt that explains how in this module, they will be treating multiple sites differently from how they did in Module 2, and not creating a separate column for each of them.
Introducing the code group_by, so that they can group by the site without having to make separate columns for each site. 
#Group_by in dplyr
```{r group by}
dplyr::group_by(biomass, Site)
```
They will need to do this again after they convert the units, but this first time is the "we do" portion. 


The quadrats are basically samples of the plant biomass, which can roughly tell us the amount of nutrients and calories available for bison and other herbivores, at each site. It is not feasible to collect this data for the entire site, so we have to take samples that can give us a general idea of the biomass of the entire site.

This dataset doesn't quite give the information the tribal agriculture managers are looking
for. Since there are multiple quadrants of data at each site, those are many small data points that can't tell the overall available biomass at each site.

####The big question####
What we have right now is the biomass in fifty 0.25 square meter quadrats at each site. How can we turn these fifty values into an estimate of the total biomass at each site?


Using group_by and summary to get the average biomass/quadrat at each site
```{r group and summary}
biomass %>%
  group_by(Site) %>% 
  summarise(avg=mean(Biomass))
```
Since we've found the average biomass at each site, it might be useful to include those in the data set to give a more clear idea of how much biomass is available at each site.
#Need to make a new column where those average values can go, right? Check on this


#Converting the units#
All of the unit conversions that need to happen: 
  currently in g/0.25 m2 and want to get to kg/acre (not tied to these specific units)
  Conversion of g/0.25 m2 to kg/acre is * 16.1874257 
Need to make a new column with the converted units
```{r}
  mutate(biomass, kg/acre = Biomass * 16.1874257) #check that this works
```
** is this where we're asking them how many bison can we introduce or is this still biomass?
Need to check if this also does that equation for the summary statistics rows or not. If not, they will have to take the summary stats of each site again. 

This would be where I give them the example for the mutate function, but then have them do it on their own to relate it to Bison, and to get the total biomass at each site. The code written below is for our purposes, which they will have to make on their own most likely:

#Taking the average biomass/plot at the kg/acre units, and multiplying that by the size of each site
For this, would probably be best to do the mutate, but in the bison_sites dataset, not the biomass dataset, because of how it is structured. Would probably be much easier! 
```{r total biomass at each site}
mutate(Bison_Sites, Total_Biomass=Acres *)
```

#Dividing that by the amount needed per bison to get total number of bison (TBD)
```{r}
mutate(Bison_Sites, Max_Bison = Total_Biomass / ___)
```

